version: 2

models:

  - name: raw_orders 
    tests:
 
      # ✅ TC_05 — Row Count Validation
      - row_count_check:
          tags: ['postload','recon_tests']
          compare_model: source('landing', 'landing_orders')   

      # ✅ TC_05 — Aggregation Validation
      - aggregation_validation:
          tags: ['postload','recon_tests']
          compare_model: source('landing', 'landing_orders')   
          column_name: AMOUNT

    columns:
      - name: 'order_id'
        tags: ['postload','data_quality']
        data_tests:
          - unique
          - not_null      