version: 2

models:

  - name: raw_synd
    tests:
      # ✅ TC_01 — Schema Validation
      - column_set_match:
          compare_model: ref('landing_tables_union')    

      # ✅ TC_02 — Data Type Validation
      - datatype_match:
          compare_model: ref('landing_tables_union')  

      # ✅ TC_03 — Primary Key Completeness 
      - pk_completeness:
          compare_model: ref('landing_tables_union')  
          key: ID

      # ✅ TC_04 — Null Ratio Consistency
      - null_ratio_diff:
          compare_model: ref('landing_tables_union')  
          column: UNIT_PRICE
          threshold: 0.05     

      # ✅ TC_05 — Row Count Validation
      - row_count_check:
          compare_model: ref('landing_tables_union')      

      # ✅ TC_06 — Aggregation Validation
      - aggregation_validation:
          compare_model: ref('landing_tables_union')  
          column_name: UNIT_PRICE

      # ✅ TC_06 — Field-Level Comparison
      - field_value_match:
          compare_model: ref('landing_tables_union')  
          by_key: ID
          columns: [ITEM]

    columns:
      - name: 'id'
        data_tests:
          - unique
          - not_null      




 